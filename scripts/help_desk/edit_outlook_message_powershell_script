$username= Read-Host "Username"
$software= Read-Host "Software"
$ticketNumber= Read-Host "Ticket Number"
$issue= Read-Host "Title Issue"
$whatsGoingOn = Read-Host "Body message"
# Path to the .msg template file
$templatePath = "C:\path\to\your\template.msg"
# Path to save the modified .msg file
$outputPath = "C:\path\to\output\modified-$ticketNumber.msg"

# Function to replace text in .msg file
function Update-MsgFile {
    param (
        [string]$templatePath,
        [string]$outputPath,
        [string]$userName,
        [string]$software,
        [string]$ticketNumber,
        [string]$issue,
        [string]$whatsGoingOn
    )

    # Load the Outlook COM object
    $outlook = New-Object -ComObject Outlook.Application
    $msg = $outlook.CreateItemFromTemplate($templatePath)

    # Update the message properties
    $msg.To = $userName
    $msg.Subject = "$ticketNumber - $software - $($whatsGoingOn.ToUpper())"
    $msg.Body = "We received
    $issue"

    # Save the updated message
    $msg.SaveAs($outputPath)

    # Open the updated message
    $msg.Display()
}

# Call the function to update the .msg file
Update-MsgFile -templatePath $templatePath -outputPath $outputPath -userName $userName -software $software -ticketNumber $ticketNumber -issue $issue -whatsGoingOn $whatsGoingOn

# Output result
Write-Output "MSG file processed and opened."
